dist: bionic

language: go

go: stable

env:
  global:
    - GO111MODULE=on
    - secure: "psWVljWA0cQht7k3cONy//XbHfBt2FcSbwIG/OxEzadYcTcnDuGeU895x9iOsFDA7u3LxLEd00qUjpE7x6oQOgfm3ygVTfJCzG/3ySwdfeQ5T3jES7VL47YVs3wIRv5KXLHzsazHTaWqF/B/YCHRVnQy2C4dMYsn+b6PVXcpF+ZEV9WDk3c3z7CkD5Vfo35CeYIxKuMAS3eo5hkkqefB58h/Ye2i5cFMMq8ckzXd4ZwU8e9X0ljDYlrW1DzdSUyh+1KpVxXN9xj4oO60RRUqEr9e3overrnYMlEu6H7wKru+ZvcEOIWrs7OU25ZEeCOmr4Rmjr2P3Z5tXPw18qDnjblY6BZ0sSlqPG7zvKvKHK4x7zpnGlrtMiixM5FWuaGlUPNsMlWmGLsy9mWXyhEvJgKSXEaoMRXR0zDIJ81x6id7TCnZBMlX1I/zTG5ZrJgoQRF2hXo26rBXgkzjExzzvqUM0yQ/cTB8FCUwOlk/dwCoTokn+jj8Gs+5N69sgRpvcDYnNA+zI9xSyAaxBJikMNw8JUshWDpQldfBnWm0vL3NFGVWaHr2jd7tT6XPO44cL1O1AD76AzNfdY4RmxT3d2DueucfLJQwjEh7O/p0VhgwfZYaqQ3W2y8uqddy4N+EEnwDuJiUJGnt3dJyr/r8Avkv3Qm+qqFXguuJSEmXKZo="
git:
  depth: 1

before_install:
  - go get github.com/mattn/goveralls
  - go get -u github.com/rakyll/gotest

install: true

before_script:
  - sudo apt-get install ruby-dev && sudo gem install travis
  - npm install -g travis-status
  - npm install -g child_process
script:
  - |
    ls -a
    echo ${TRAVIS_PULL_REQUEST}
    echo ${TRAV_API_TOKEN}
    if [ "${TRAVIS_PULL_REQUEST}" == "false"  ]; then 
      make install; 
      gotest -v -covermode=count -coverprofile=coverage.out ./x/...; 
      $GOPATH/bin/goveralls -coverprofile=coverage.out -service=travis-ci;
      ls -l $GOPATH/bin;
    else 
      travis login --pro --github-token $TRAV_API_TOKEN;
      echo "y" | travis restart -r bluzelle/curium-test; 
      npm install travis-status; 
      node travisStatus.js $TRAV_API_TOKEN; 
    fi

    