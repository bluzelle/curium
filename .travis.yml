dist: bionic

language: go

go: stable

env:
  global:
    - GO111MODULE=on
    - secure: "SkWjSxPuBapff1YDviaRRJf8dEkjre15y2kGqVOpiHSAfuFMFCidEsaMOSrI9A1K+tV9IacqTUdwX+64SPF/9H3pWkqOqPaPxkz2dIAZjhpB2AtXkGh/cCgmAkVkIyifJwOTJlfSWqenu/uN78geeT+nqWSEgNzhwo3zys2sWGehtb9B2oiibP4glkxtzQu4TlPvQrMistEgSNerAmMADHxd05vto1ZGPHuAw7VRGPtly9KNh8STISkKrk22g5qSAt9p9uPzxkW9HEmnUqG/BhjwUm/fcFwGdq/9qjk9QAFM2Ft/NqTQR6tSctD09EkII/tM7sok0M31eRCjd4SCYlWv/aDzayEjxy4++W41JxzCIIgxGS8Pu60GXwdS6gEC8YCxQ2LCTAB2NMN1e4GjsEd05V/+fYAkYVzmw1WxlL6iSwA9cFp20aw/RPy9wK1vbRFbXuxSI45GjwVpr5XKQ5DtOMh1Svy1f6b4nIaEVjbXzftgT3Te04SnmaXd85VnLQUKowMiAO1Z9KG8CBWM/F8m8NV03ppt0ba8ml0YjbKZD16FUONzpB7okpo9CPeGgznrHOAaY21XOlb2tzJ7K75OWbRHxerrG442RXC/3OYqBzljxN0alVbUd33xpUrC6NUUHN4v7hdvd6WW8gLjOAnZ1LDee9hDTP599uHRvFs="
git:
  depth: 1

before_install:
  - go get github.com/mattn/goveralls
  - go get -u github.com/rakyll/gotest

install: true

before_script:
  - sudo apt-get install ruby-dev && sudo gem install travis
  - npm install -g travis-status
  - npm install -g child_process
script:
  - |
    ls -a
    echo ${TRAVIS_PULL_REQUEST}
    echo ${TRAV_API_TOKEN}
    if [ "${TRAVIS_PULL_REQUEST}" == "false"  ]; then 
      make install; 
      gotest -v -covermode=count -coverprofile=coverage.out ./x/...; 
      $GOPATH/bin/goveralls -coverprofile=coverage.out -service=travis-ci;
      ls -l $GOPATH/bin;
    else 
      sudo travis login --pro --github-token $TRAV_API_TOKEN;
      echo "y" | travis restart -r bluzelle/curium-test; 
      npm install travis-status; 
      node travisStatus.js $TRAV_API_TOKEN; 
    fi

