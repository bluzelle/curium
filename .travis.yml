dist: bionic

language: go

go: stable

env:
  global:
    - GO111MODULE=on
    - secure: "dnbjXj7c3iE4MLEevOUUqGDxr9tKDX/3qnFnM38RaObCgVsaxgQ3kFQGGLpw0uBllL7qh4lWwTzV2druEpoolE5Ecb4M2Xq2uHGXuD4Ulow9zR66x1qNpRKCNyCHglJj2oPU5mx0O4lGOY4f0GL5O1mGe2fOdOA3WD7+rquwdPH8J/hgfFQE3lvu3Fa9ZCDxbk69pgKz0qpeAvg2m0bv/iWKctpXxAufdq8GmiCKFSh6eey28qOfCU55VrqTq19pw6Q1nrl2QaApoqorDRXPvziznO4UgQyf1p6cl2MjAHm78KFnH9tdWOpmtZbUlgY4tEqbzZbhosyKNmPSTp7xRvzpeIulnvCJ6kKmrOi2KOdlH9kcoY29QZAkNUcKQvMnYASUbtinWA0Cn5t4Lr7psXUJw9f9+b8nOkycij0ogOucetipzRWiyXLR3Ii/GEMoioUbQHp6VsQTLTI1JV/K8/Bh8Uz4QQS+xbxhFuwO8Npo3bGxlo2O0aYsEdakyMvg1MIETteawkAJCTTznKza9lycKilUH+wR2rnGPtzJHlcKL3oLe7gDZGaLXxqhQcYo7ScW0WvA79FqUf6hJr/ETyw3jJ5LrW6ngi+z4hcNuJwau6fN9iaMbmjUVEsGgOZDaDuqYSRfK0sb8V+5n/gamV+Uqm2gSzAbHHmtmxkhOf8="
git:
  depth: 1

before_install:
  - go get github.com/mattn/goveralls
  - go get -u github.com/rakyll/gotest

install: true

before_script:
  - sudo apt-get install ruby-dev && sudo gem install travis
  - npm install -g travis-status
  - npm install -g child_process
script:
  - |
    ls -a
    echo ${TRAVIS_PULL_REQUEST}
    echo ${TRAV_API_TOKEN}
    if [ "${TRAVIS_PULL_REQUEST}" == "false"  ]; then 
      make install; 
      gotest -v -covermode=count -coverprofile=coverage.out ./x/...; 
      $GOPATH/bin/goveralls -coverprofile=coverage.out -service=travis-ci;
      ls -l $GOPATH/bin;
    else 
      travis login --pro --github-token $TRAV_API_TOKEN;
      echo "y" | travis restart -r bluzelle/curium-test; 
      npm install travis-status; 
      node travisStatus.js $TRAV_API_TOKEN; 
    fi

    