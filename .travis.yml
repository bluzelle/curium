dist: bionic

language: go

go: stable

env:
  global:
  - GO111MODULE=on
  secure: "LBPuPqFb4PYq9n0d6vQ+TwFWwepAsl3X3ZoRyWU+4/kv3S50PRzre60B5xVP+Y3eyG5RbsWh1Z4unp2nVOGN9O3H4VjqgAXQYnyTMIzg+AceUnjVmlbzPL01A0tTY5MswbZP3ncQFphBNreRrIWgLZKV9btfiYjuOO85+ZC+biw3jNuyeGkHSdfibAsuKug0Mr11FkYccAry3zOUHwNzn2dMnfDVImPmjxucZxXOqIeqXaPQ9W8OVn+ZiYYoW51+s/G1ll00C290c6TKbnVnFVqK6cAR9VQnpI00IDLuRNGQJWiosHCxoYkr/p9nSZgN04nVRYvkLXo8CxSsthcYf23Z1R0H5NeFuCVfLSzAgFOff23VK2jOhINPgCfBtENMyR4jVdUSCv0XJ/VrjHHMJXzpILXSy/M38RnZzeN2brM6H7nbvk58Kdv+6Dn7A1E2ZLCslFtlP4m6qrP17bDViibfVgYNcRytDATnKXjbJURAJ3ja+ZUULLPMhAO5BDHuJDzIWXq2wzZWk4OMk49PIaVwkSvaJ8+KFg9x7mNXGhql5TAS+d+OArkJyzR1ODQnfZ0JA1rzvJ9T321lOT8YzWy8nEPfRcpAbrIuud1Rrj4r4luOaZ6iRmGvOtrnKCDjciQCY+J1ftJj5U+uDeZt0A9Bxo1DFy/tW96KX0QxvwI="
  
git:
  depth: 1

before_install:
  - go get github.com/mattn/goveralls
  - go get -u github.com/rakyll/gotest

install: true

before_script:
  - sudo apt-get install ruby-dev && sudo gem install travis
  - npm install -g travis-status
script:
  - ls -a
  - echo ${TRAVIS_PULL_REQUEST}
  - echo "y" | travis login --pro --github-token $TRAV_TOKEN
  - travis-status --pro --token $TRAV_TOKEN
  - if [ "${TRAVIS_PULL_REQUEST}" == "false"  ]; then make install;gotest -v -covermode=count -coverprofile=coverage.out ./x/...;$GOPATH/bin/goveralls -coverprofile=coverage.out -service=travis-ci;ls -l $GOPATH/bin; else echo "y" | travis restart -r bluzelle/curium-test; travis-status --repo bluzelle/curium-test --branch task/milagan/cm-89 --fail-pending || echo 'Not yet passing'; fi
